---
import type { MarkdownInstance } from "astro";
import dayjs from "dayjs";

import BaseLayout from "../../layouts/baseLayout.astro";
import type { ProjectFrontmatter } from "../../types/project.domain";

interface Props {
  currentProject: MarkdownInstance<ProjectFrontmatter>;
}

export async function getStaticPaths() {
  const allProjects = await Astro.glob<ProjectFrontmatter>(
    "../../content/projects/*.md",
  );

  return allProjects.map((project) => ({
    params: {
      project: project.frontmatter.slug,
    },
    props: {
      currentProject: allProjects.find(
        (p) => p.frontmatter.slug === project.frontmatter.slug,
      ),
    },
  }));
}

const { currentProject } = Astro.props;

const Content = currentProject.Content;

const formatedDate = dayjs(currentProject.frontmatter.date).format(
  "MMMM DD, YYYY",
);
---

<BaseLayout>
  <article
    class="prose prose-slate mt-32 max-w-none dark:prose-invert lg:prose-xl"
  >
    <h1>{currentProject.frontmatter.title}</h1>
    <span>
      {`${formatedDate} â€¢ ${currentProject.frontmatter.tags.join(", ")}`}
    </span>
    <img class="w-full object-cover" src={currentProject.frontmatter.image} />
    <Content />
  </article>
</BaseLayout>
